<!-- wsdSearchFilterTemplate -->
<!-- RC - changed -->
<!-- RC - different notification blocks for separate purposes -->
<div class="search-notification">
  <!-- wsdNotificationDiffTz -->
  <wsd-notification-diff-tz
    notification-config="searchNotificationConfigDiffTz"
    show-notification-tz="showSearchNotificationDiffTz"
  >
  </wsd-notification-diff-tz>
</div>
<div class="search-notification">
  <!-- wsdNotificationMaxDays -->
  <wsd-notification-max-days
    notification-config="searchNotificationConfigMaxDays"
    show-notification-max-days="showSearchNotificationMaxDays"
  >
  </wsd-notification-max-days>
</div>

<section class="search-filter">
  <div class="row">
    <div ng-class="enableRecurring ? 'col-md-11' : 'col-md-10'">
      <div class="flex-row row-margin">
        <div class="flex col-pad col-2-max-flex-width">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Building}"
            title="${Building}"
          >
            <strong
              ><span
                ng-class="!building.value ? 'mandatory' : 'mandatory-filled'"
                >*</span
              ></strong
            >
            ${Building}
          </label>
          <div
            class="building-picker"
            ng-class="{ 'is-invalid': hasSearched && !building.value }"
          >
            <sn-record-picker
              id="building-picker"
              table="'sn_wsd_core_building'"
              default-query="buildingPickerEQ"
              field="building"
              value-field="'sys_id'"
              display-field="'u_display_name'"
              display-fields="'campus'"
              search-fields="'u_display_name'"
              page-size="100"
              placeholder="${Select a building}"
              sn-disabled="disableChangeLocation"
              on-change="buildingChange(building)"
            >
            </sn-record-picker>
          </div>
        </div>
        <div class="flex col-pad col-2-max-flex-width">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Type}"
            title="${Type}"
          >
            <strong
              ><span
                ng-class="
                  !reservable_module.value ? 'mandatory' : 'mandatory-filled'
                "
                >*</span
              ></strong
            >
            ${Type}
          </label>
          <div
            class="module-picker"
            ng-class="{ 'is-invalid': hasSearched && !reservable_module.value }"
          >
            <sn-record-picker
              id="reservable-module-picker"
              table="'sn_wsd_rsv_reservable_module'"
              default-query="reservableModulePickerEQ"
              field="reservable_module"
              value-field="'sys_id'"
              display-field="'name'"
              display-fields="'short_description'"
              search-fields="'name'"
              page-size="10"
              sn-disabled="disableChangeModule"
              on-change="moduleChange(reservable_module)"
              placeholder="${Select a reservable type}"
            >
            </sn-record-picker>
          </div>
        </div>

        <div class="flex col-pad col-2-max-flex-width" ng-if="shiftMode">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - shift schedule}"
            title="${Shift schedule}"
          >
            <strong
              ><span
                ng-class="
                  !$parent.selectedShift.value
                    ? 'mandatory'
                    : 'mandatory-filled'
                "
                >*</span
              ></strong
            >
            ${Shift schedule}
          </label>
          <div
            class="module-picker"
            ng-class="{ 'is-invalid': hasSearched && !reservable_module.value }"
          >
            <sn-record-picker
              id="reservable-shift-picker"
              table="'sn_wsd_core_shift'"
              default-query="shiftQuery"
              field="$parent.selectedShift"
              value-field="'sys_id'"
              display-field="'name'"
              display-fields="'shift_detail'"
              search-fields="'name'"
              page-size="10"
              sn-disabled="disableChangeModule"
              on-change="shiftChange($parent.selectedShift)"
              placeholder="${Select a reservable type}"
            >
            </sn-record-picker>
          </div>
        </div>
        <!-- Shift start-->
        <div class="flex col-pad col-2-max-flex-width" ng-if="shiftMode">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - start date}"
            title="${Start date}"
          >
            <strong
              ><span
                ng-class="
                  !$parent.shiftStart.value ? 'mandatory' : 'mandatory-filled'
                "
                >*</span
              ></strong
            >
            ${Start date}
          </label>
          <div
            class="module-picker"
            ng-class="{ 'is-invalid': hasSearched && !reservable_module.value }"
          >
            <sp-date-picker
              field="{name: 'shift_start_date'}"
              ng-model="$parent.shiftStart.value"
              sn-include-time="false"
              sn-change="onShiftStartChange()"
            >
            </sp-date-picker>
          </div>
        </div>
        <!-- Normal start and end-->
        <div class="flex col-pad col-2-max-flex-width" ng-if="!shiftMode">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Start date and time}"
            title="${Start date and time}"
          >
            <strong
              ><span ng-class="!start.value ? 'mandatory' : 'mandatory-filled'"
                >*</span
              ></strong
            >
            ${Start date and time}
          </label>
          <div
            class="start-picker"
            ng-class="hasSearched && !start.value ? 'is-invalid' : ''"
          >
            <sp-date-picker
              field="{name: 'start_time'}"
              ng-model="start.value"
              sn-include-time="true"
              sn-change="timeChange('start')"
            >
            </sp-date-picker>
          </div>
        </div>
        <div class="flex col-pad col-2-max-flex-width" ng-if="!shiftMode">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Recurring series end date and time}"
            title="${End date and time}"
          >
            <strong
              ><span ng-class="!end.value ? 'mandatory' : 'mandatory-filled'"
                >*</span
              ></strong
            >
            ${End date and time}
          </label>
          <div
            class="end-picker"
            ng-class="hasSearched && !end.value ? 'is-invalid' : ''"
          >
            <sp-date-picker
              field="{name: 'end_time'}"
              ng-model="end.value"
              sn-disabled="isEndDateDisabled()"
              sn-include-time="true"
              sn-change="timeChange('end')"
            >
            </sp-date-picker>
          </div>
        </div>
        <div class="col-pad" ng-show="enableRecurring">
          <label
            for="recurringSlider"
            class="text-overflow-ellipsis search-label"
            aria-label="${Recurring}"
            title="${Recurring}"
          >
            ${Recurring}
          </label>
          <wsd-slider
            id="recurringSlider"
            data="isRecurring"
            wsd-on-change="onIsRecurringChanged"
          >
          </wsd-slider>
        </div>
      </div>
      <div class="flex-row all-day-selection" ng-if="enableAllDayOption">
        <div class="checkbox-wrapper">
          <input
            type="checkbox"
            ng-checked="isAllDay"
            id="isAllDayInput"
            ng-click="toggleAllDay($event)"
          />
          <label for="isAllDayInput">${All day}</label>
        </div>
      </div>
      <!-- SHIFT DETAILS BLOCK-->
      <div
        class="flex-row row-margin filter-extra-details shift-details-block"
        ng-if="hasSelectedShift()"
      >
        <div class="col-2-max-flex-width shift-details flex col-pad">
          <label
            for="shiftDetails"
            class="text-overflow-ellipsis search-label"
            aria-label="${Shift details}"
            title="${Shift details}"
          >
            ${Shift details}
          </label>
          <div class="control-view">
            <div id="shiftDetails">
              {{
                hasSelectedShift() && selectedShift.shiftDetails
                  ? selectedShift.shiftDetails
                  : "N.A"
              }}
            </div>
          </div>
        </div>
        <div
          class="col-2-max-flex-width flex col-pad"
          ng-show="isRecurring.value && enableRecurring"
        >
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - end date for recurring}"
            title="${Recurring end date}"
          >
            <strong
              ><span
                ng-class="
                  !$parent.shiftRecurringEnd.value
                    ? 'mandatory'
                    : 'mandatory-filled'
                "
                >*</span
              ></strong
            >
            ${Recurring end date}
          </label>
          <div
            class="module-picker"
            ng-class="{ 'is-invalid': hasSearched && !reservable_module.value }"
          >
            <sp-date-picker
              field="{name: 'shift_recurring_end_date'}"
              ng-model="$parent.shiftRecurringEnd.value"
              sn-include-time="false"
              sn-change="recurringShiftTimeValidation()"
            >
            </sp-date-picker>
          </div>
        </div>
      </div>
      <!-- RECURRING BLOCK-->
      <div
        class="flex-row row-margin filter-extra-details recurring-details-block"
        ng-show="!shiftMode && isRecurring.value && enableRecurring"
      >
        <div class="col-2-max-flex-width flex col-pad">
          <label
            for="repeatsSelector"
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Repeat}"
            title="${Repeat}"
          >
            <strong><span class="mandatory-filled">*</span></strong> ${Repeat}
          </label>
          <div class="control-view">
            <div
              id="repeatsSelector"
              select2
              select2-options="repeatsSelect2Options"
              ng-model="recurringRepeats"
              ng-change="triggerCalcOccurrences()"
              aria-label="${Repeat}"
            ></div>
          </div>
        </div>
        <div class="col-pad" ng-show="recurringRepeats === 'weekly'">
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Days}"
            title="${Days}"
          >
            <strong
              ><span
                ng-class="!recurringDays ? 'mandatory' : 'mandatory-filled'"
                >*</span
              ></strong
            >
            ${Days}
          </label>
          <wsd-day-selector
            ng-model="recurringDays"
            on-change="(triggerCalcOccurrences)"
          ></wsd-day-selector>
        </div>
        <div class="col-2-max-flex-width flex col-pad">
          <label
            for="duration-selector"
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Lasts}"
            title="${Lasts}"
          >
            <strong><span class="mandatory-filled">*</span></strong> ${Lasts}
          </label>
          <div class="control-view">
            <div
              id="duration-selector"
              select2
              select2-options="recurringDurationSelect2Options"
              ng-model="recurringDurationType"
              ng-change="triggerCalcOccurrences()"
              aria-label="${Lasts}"
            ></div>
          </div>
        </div>
        <div
          class="col-2-max-flex-width flex col-pad"
          ng-show="recurringDurationType === 'for'"
        >
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Number of occurrences}"
            title="${Number of occurrences}"
          >
            <strong
              ><span
                ng-class="!occurrenceCount ? 'mandatory' : 'mandatory-filled'"
                >*</span
              ></strong
            >
            ${Number of occurrences}
          </label>
          <wsd-number-input
            ng-model="occurrenceCount"
            min="2"
            max="180"
          ></wsd-number-input>
          <small class="text-muted line-height-30">${180 max}</small>
        </div>
        <div
          class="flex col-pad col-2-max-flex-width"
          ng-show="recurringDurationType === 'until'"
        >
          <label
            class="text-overflow-ellipsis search-label"
            aria-label="${Required - Date and time}"
            title="${Date and time}"
          >
            <strong
              ><span
                ng-class="
                  !recurringEnd.value ? 'mandatory' : 'mandatory-filled'
                "
                >*</span
              ></strong
            >
            ${Date and time}
          </label>
          <div class="recurring-end-picker">
            <sp-date-picker
              field="{name: 'recurring_end_time'}"
              ng-model="recurringEnd.value"
              sn-include-time="true"
              sn-change="timeChange('recurringEnd')"
            >
            </sp-date-picker>
          </div>
          <small class="text-muted line-height-30"
            >{{ amountOfOccurrences }} ${occurrences}</small
          >
        </div>
      </div>
    </div>
    <div ng-class="enableRecurring ? 'col-md-1' : 'col-md-2'">
      <div class="row">
        <div class="col-md-12">
          <button
            class="btn btn-primary btn-search button text-overflow-ellipsis"
            title="${Search}"
            type="button"
            role="button"
            ng-disabled="isLoading || !canSearch"
            aria-label="${Get a list of available spaces}"
            ng-click="searchHandler()"
          >
            ${Search}
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
<hr ng-hide="isRecurring.value || hasSelectedShift()" />
